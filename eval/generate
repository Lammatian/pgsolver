#!/usr/bin/env python3

import subprocess
import sys

gametypes = ["random", "sparse", "steady"]

def parse_args():
    if not sys.argv[1] in gametypes:
        print("Wrong game type")
        exit(1)
    else:
        gametype = sys.argv[1]

    try:
        number = int(sys.argv[2])
    except:
        print("number of games should be an integer")
        exit(1)

    try:
        size = int(sys.argv[3])
    except:
        print("size should be an integer")
        exit(1)

    return (gametype, number, size)

# generate the game and save to file
def generate(gametype, size, idx):
    if gametype == "random":
        cmd = "../bin/randomgame "
        cmd += str(size) + " "
        cmd += str(size) + " "
        cmd += "1 "
        cmd += str(size)
    elif gametype == "sparse":
        cmd = "../bin/randomgame "
        cmd += str(size) + " "
        cmd += str(size) + " "
        cmd += "2 5"
    else:
        cmd = "../bin/steadygame "
        cmd += str(size) + " "
        cmd += "1 5 1 5"

    filename = gametype + "_" + str(size) + "_" + str(idx) + ".gm"
    f = open(filename, "w")

    p = subprocess.call(cmd, shell=True, stdout=f)
    return p


def main():
    gametype, number, size = parse_args()

    for i in range(1, number+1):
        rc = generate(gametype, size, i) 
        if rc != 0:
            print("error")
            exit(1)

if __name__ == "__main__":
    main()
